@echo off
rem
rem Runs clang-tidy on a source file with a single check enabled.
rem
rem clang-tidy is assumed to be in the path and the directory ../build-ninja
rem is assumed to exist and contain a compile_commands.json file generated by
rem the Ninja build generator.
rem
rem Usage: run-clang-tidy [check] [file]
rem
rem Example: run-clang-tidy readability-braces-around-statements RefactorTest\AddBlockDelimiter.cpp
rem
if not exist ..\build-ninja goto no-ninja
if not exist ..\build-ninja\compile_commands.json goto no-ninja
if "X%1"=="X" goto bad-args
if "X%2"=="X" goto bad-args

clang-tidy --fix -p ../build-ninja --checks=-*,%1 %2
exit /b 0

:no-ninja
echo Missing build-ninja directory.  Use CMake preset ninja to generate compile_commands.json in ninja build.
exit /b 1

:badargs
echo Usage: run-clang-tidy [check] [file]
exit /b 1
